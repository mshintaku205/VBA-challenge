Sub stockdata()Dim ws As WorksheetDim tickertable As LongDim Iprice As DoubleDim fprice As DoubleDim change As DoubleDim percentchange As DoubleFor Each ws In ThisWorkbook.Worksheetsws.Activatews.Cells(1, "i") = "Ticker"ws.Cells(1, "j") = "Quarterly Change"ws.Cells(1, "k") = "Percent Change"ws.Cells(1, "l") = "Total Stock Volume"ws.Cells(2, "o") = "Greatest % Increase"ws.Cells(3, "o") = "Greatest % Decrease"ws.Cells(4, "o") = "Greatest Total Volume"maxpercent = WorksheetFunction.Max(Range("k2:k1501"))minpercent = WorksheetFunction.Min(Range("k2:k1501"))maxvolume = WorksheetFunction.Max(Range("l2:l1501"))ws.Cells(2, "q") = maxpercentws.Cells(3, "q") = minpercentws.Cells(4, "q") = maxvolumews.Range("k2:k1501").NumberFormat = "0.00%"ws.Range("q2:q3").NumberFormat = "0.00%"ws.Range("q4").NumberFormat = "000,000"ws.Range("l2:l1501").NumberFormat = "000,000"tickertable = 2percentchange = 0fprice = 0lprice = 0change = 0volume = 0    For r = 2 To 93001        If ws.Cells(r + 1, 1).Value <> Cells(r, 1).Value Then            ws.Cells(tickertable, "i").Value = Cells(r, 1).Value            ws.Cells(tickertable, "l").Value = volume + Cells(r, 7).Value            volume = 0                        lprice = ws.Cells(r, "f")            change = lprice - fprice            If fprice <> 0 Then            percentchange = change / fprice                    End If            ws.Cells(tickertable, "K") = percentchange    fprice = ws.Cells(r + 1, "C")    ws.Cells(tickertable, "J") = change        tickertable = tickertable + 1    Else    volume = volume + Cells(r, 7).Value                    End If    Next rNext ws    End Sub